// https://docs.renovatebot.com/configuration-options/

{
    "$schema": "https://docs.renovatebot.com/renovate-schema.json",

    "goGetDirs": [ "./..." ],
    "postUpdateOptions": [
        "gomodTidy",
        "gomodUpdateImportPaths"
    ],

    "postUpgradeTasks": {
        "commands": [ "go generate ./..." ],
        "executionMode": "branch",
        "fileFilters": [ "go.mod" ]
    },

    "ignorePaths": [
        "**/testdata/**"
    ],

    "packageRules": [
        {
            // block all updates on "go" directive in go.mod (but not "toolchain" directive)
            "enabled": false,
            "matchDepNames": [ "go" ],
            "matchDepTypes": [ "golang" ],
            "matchManagers": [ "gomod" ]
        },
        {
            // force grouping of go.mod minor versions, even for pre-1.0 versions
            "matchManagers": [ "gomod" ],
            "matchUpdateTypes": [ "patch", "minor" ],
            "groupName": "Go dependencies (non-major)",
            "groupSlug": "go-dependencies-non-major"
        }
    ]
}
